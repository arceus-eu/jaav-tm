<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>>Jaav-tm</title>
</head>
<body>
<script type="module">

     import('./src/index.js').then( module => {

         const webclient = new WebClient('ws://5.157.85.76:3000');
         webclient.connect().then(async () => {

             let accounts = await webclient.getAccounts();
             await webclient.compile();
             let contracts = await webclient.getContracts();

             let address = contracts.filter(item => { return item.name === 'HelloWorld' })[0].address;

             if (!address) {
                 let deploy = await webclient.deploy(accounts[0], '1234', 'HelloWorld');
                 address = deploy.address;
             }

             const helloWorld = await webclient.getContract(address, accounts[0]);

             helloWorld.onSetGreeting = (result, options) => {
                helloWorld.hello('Terence');
             };

             helloWorld.onHello = (result, options) => {
                console.log(result);
             };

             helloWorld.onSetObject = async (result, options) => {
                 console.log(await helloWorld.getObject());
             };

             helloWorld.setGreeting('Hi');

             helloWorld.setObject({
                 test : 'test'
             });

         });
     });

</script>
</body>
</html>
